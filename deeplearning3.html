<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Pembuat Modul Ajar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .loading {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-full">
    <div class="min-h-full">
        <!-- Header -->
        <header class="gradient-bg text-white py-6">
            <div class="max-w-7xl mx-auto px-4">
                <h1 class="text-3xl font-bold text-center">üìö Dashboard Pembuat Modul Ajar</h1>
                <p class="text-center mt-2 text-blue-100">Buat modul ajar berkualitas dengan bantuan AI sesuai kurikulum Deep Learning</p>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Form Input -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="bg-blue-100 p-2 rounded-lg mr-3">üìù</span>
                        Data Identifikasi Modul Ajar
                    </h2>
                    
                    <form id="modulForm" class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label for="penyusun" class="block text-sm font-medium text-gray-700 mb-2">Penyusun</label>
                                <input type="text" id="penyusun" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nama guru penyusun">
                            </div>
                            <div>
                                <label for="satuan" class="block text-sm font-medium text-gray-700 mb-2">Satuan Pendidikan</label>
                                <input type="text" id="satuan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nama sekolah">
                            </div>
                        </div>

                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label for="tahun" class="block text-sm font-medium text-gray-700 mb-2">Tahun Pelajaran</label>
                                <input type="text" id="tahun" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2024/2025">
                            </div>
                            <div>
                                <label for="semester" class="block text-sm font-medium text-gray-700 mb-2">Semester</label>
                                <select id="semester" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">Pilih Semester</option>
                                    <option value="1">Semester 1</option>
                                    <option value="2">Semester 2</option>
                                </select>
                            </div>
                            <div>
                                <label for="kelas" class="block text-sm font-medium text-gray-700 mb-2">Kelas/Fase</label>
                                <input type="text" id="kelas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="X / Fase E">
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label for="mapel" class="block text-sm font-medium text-gray-700 mb-2">Mata Pelajaran</label>
                                <input type="text" id="mapel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Matematika">
                            </div>
                            <div>
                                <label for="topik" class="block text-sm font-medium text-gray-700 mb-2">Topik/Elemen</label>
                                <input type="text" id="topik" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Fungsi Kuadrat">
                            </div>
                        </div>

                        <div>
                            <label for="alokasi" class="block text-sm font-medium text-gray-700 mb-2">Alokasi Waktu</label>
                            <input type="text" id="alokasi" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="2 x 45 menit">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Dimensi Profil Lulusan</label>
                            <div class="grid md:grid-cols-2 gap-2">
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="keimanan" class="rounded text-blue-600">
                                    <span class="text-sm">Keimanan dan Ketakwaan</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="kewargaan" class="rounded text-blue-600">
                                    <span class="text-sm">Kewargaan</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="penalaran" class="rounded text-blue-600">
                                    <span class="text-sm">Penalaran Kritis</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="kreativitas" class="rounded text-blue-600">
                                    <span class="text-sm">Kreativitas</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="kolaborasi" class="rounded text-blue-600">
                                    <span class="text-sm">Kolaborasi</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="kemandirian" class="rounded text-blue-600">
                                    <span class="text-sm">Kemandirian</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="kesehatan" class="rounded text-blue-600">
                                    <span class="text-sm">Kesehatan</span>
                                </label>
                                <label class="flex items-center space-x-2 p-2 rounded hover:bg-gray-50">
                                    <input type="checkbox" name="dimensi" value="komunikasi" class="rounded text-blue-600">
                                    <span class="text-sm">Komunikasi</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="sarana" class="block text-sm font-medium text-gray-700 mb-2">Sarana dan Prasarana</label>
                            <textarea id="sarana" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Laptop, proyektor, papan tulis, buku paket..."></textarea>
                        </div>

                        <div>
                            <label for="capaian" class="block text-sm font-medium text-gray-700 mb-2">Capaian Pembelajaran</label>
                            <textarea id="capaian" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Peserta didik mampu memahami dan menerapkan konsep..."></textarea>
                        </div>

                        <div>
                            <label for="tujuan" class="block text-sm font-medium text-gray-700 mb-2">Tujuan Pembelajaran</label>
                            <textarea id="tujuan" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Setelah mengikuti pembelajaran, peserta didik dapat..."></textarea>
                        </div>

                        <div>
                            <label for="lintas" class="block text-sm font-medium text-gray-700 mb-2">Lintas Bidang Disiplin Ilmu</label>
                            <input type="text" id="lintas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Fisika, Ekonomi, Seni...">
                        </div>

                        <div>
                            <label for="sumber" class="block text-sm font-medium text-gray-700 mb-2">Sumber Belajar</label>
                            <textarea id="sumber" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Buku paket, internet, video pembelajaran..."></textarea>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label for="model" class="block text-sm font-medium text-gray-700 mb-2">Model Pembelajaran</label>
                                <select id="model" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">Pilih Model Pembelajaran</option>
                                    <option value="Problem Based Learning">Problem Based Learning (PBL)</option>
                                    <option value="Project Based Learning">Project Based Learning</option>
                                    <option value="Discovery Learning">Discovery Learning</option>
                                    <option value="Inquiry Learning">Inquiry Learning</option>
                                    <option value="Cooperative Learning">Cooperative Learning</option>
                                    <option value="Contextual Teaching Learning">Contextual Teaching Learning</option>
                                    <option value="Blended Learning">Blended Learning</option>
                                    <option value="Flipped Classroom">Flipped Classroom</option>
                                    <option value="STEAM">STEAM</option>
                                    <option value="Differentiated Instruction">Differentiated Instruction</option>
                                    <option value="Think Pair Share">Think Pair Share</option>
                                    <option value="Jigsaw">Jigsaw</option>
                                    <option value="Mind Mapping">Mind Mapping</option>
                                    <option value="Role Playing">Role Playing</option>
                                    <option value="Demonstrasi">Demonstrasi</option>
                                    <option value="Ceramah Interaktif">Ceramah Interaktif</option>
                                    <option value="Diskusi Kelompok">Diskusi Kelompok</option>
                                    <option value="Simulasi">Simulasi</option>
                                    <option value="Studi Kasus">Studi Kasus</option>
                                    <option value="Pembelajaran Berbasis Game">Pembelajaran Berbasis Game</option>
                                </select>
                            </div>
                            <div>
                                <label for="pendekatan" class="block text-sm font-medium text-gray-700 mb-2">Pendekatan Pembelajaran</label>
                                <select id="pendekatan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">Pilih Pendekatan Pembelajaran</option>
                                    <option value="Deep Learning">Deep Learning</option>
                                    <option value="Mindful Learning">Mindful Learning</option>
                                    <option value="Meaningful Learning">Meaningful Learning</option>
                                    <option value="Joyful Learning">Joyful Learning</option>
                                    <option value="Scientific Approach">Scientific Approach</option>
                                    <option value="Constructivist Approach">Constructivist Approach</option>
                                    <option value="Humanistic Approach">Humanistic Approach</option>
                                    <option value="Behaviorist Approach">Behaviorist Approach</option>
                                    <option value="Cognitive Approach">Cognitive Approach</option>
                                    <option value="Social Learning Approach">Social Learning Approach</option>
                                    <option value="Experiential Learning">Experiential Learning</option>
                                    <option value="Collaborative Learning">Collaborative Learning</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Strategi Pembelajaran Berdiferensiasi</label>
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="bg-gray-50 p-3 rounded">
                                    <h6 class="font-medium text-gray-700 mb-2">Diferensiasi Konten</h6>
                                    <div class="space-y-1">
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_konten" value="tingkat_kesulitan" class="rounded text-blue-600">
                                            <span class="text-sm">Tingkat kesulitan bertingkat</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_konten" value="gaya_belajar" class="rounded text-blue-600">
                                            <span class="text-sm">Sesuai gaya belajar</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_konten" value="minat_siswa" class="rounded text-blue-600">
                                            <span class="text-sm">Berdasarkan minat siswa</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="bg-gray-50 p-3 rounded">
                                    <h6 class="font-medium text-gray-700 mb-2">Diferensiasi Proses</h6>
                                    <div class="space-y-1">
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_proses" value="kelompok_fleksibel" class="rounded text-blue-600">
                                            <span class="text-sm">Kelompok fleksibel</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_proses" value="scaffolding" class="rounded text-blue-600">
                                            <span class="text-sm">Scaffolding bertingkat</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_proses" value="waktu_belajar" class="rounded text-blue-600">
                                            <span class="text-sm">Waktu belajar fleksibel</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="bg-gray-50 p-3 rounded">
                                    <h6 class="font-medium text-gray-700 mb-2">Diferensiasi Produk</h6>
                                    <div class="space-y-1">
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_produk" value="pilihan_tugas" class="rounded text-blue-600">
                                            <span class="text-sm">Pilihan tugas beragam</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_produk" value="format_presentasi" class="rounded text-blue-600">
                                            <span class="text-sm">Format presentasi variatif</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="checkbox" name="diferensiasi_produk" value="rubrik_fleksibel" class="rounded text-blue-600">
                                            <span class="text-sm">Rubrik penilaian fleksibel</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label for="digital" class="block text-sm font-medium text-gray-700 mb-2">Pemanfaatan Digital</label>
                            <textarea id="digital" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Contoh: Google Classroom, Kahoot, Canva, YouTube, Padlet, Mentimeter, dll..."></textarea>
                            <p class="text-xs text-gray-500 mt-1">Isi jika menggunakan platform digital, aplikasi, atau media online dalam pembelajaran</p>
                        </div>

                        <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition duration-300 flex items-center justify-center">
                            <span id="btnText">üöÄ Buat Modul Ajar dengan ChatGPT</span>
                            <div id="loadingSpinner" class="hidden ml-2 w-5 h-5 border-2 border-white border-t-transparent rounded-full loading"></div>
                        </button>
                    </form>
                </div>

                <!-- Hasil Output -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="bg-green-100 p-2 rounded-lg mr-3">üìã</span>
                        Hasil Modul Ajar dari ChatGPT
                    </h2>
                    
                    <div id="outputArea" class="min-h-96">
                        <div class="text-center text-gray-500 py-12">
                            <div class="text-6xl mb-4">ü§ñ</div>
                            <p class="text-lg">Isi semua data di sebelah kiri untuk mulai membuat modul ajar</p>
                            <p class="text-sm mt-2">ChatGPT akan membantu Anda membuat modul pembelajaran lengkap sesuai kurikulum Deep Learning</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-8 mt-12">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center mb-6">
                    <h3 class="text-xl font-bold mb-2">üìö Dashboard Pembuat Modul Ajar</h3>
                    <p class="text-gray-300 text-sm max-w-2xl mx-auto">
                        Solusi cerdas untuk membuat modul pembelajaran berkualitas dengan bantuan AI. 
                        Dirancang khusus untuk membantu guru Indonesia menciptakan pembelajaran yang efektif dan menyenangkan.
                    </p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 mb-6">
                    <div class="text-center">
                        <h4 class="font-semibold mb-2">üéØ Fitur Unggulan</h4>
                        <ul class="text-sm text-gray-300 space-y-1">
                            <li>Analisis AI yang mendalam</li>
                            <li>Diferensiasi pembelajaran</li>
                            <li>Download format Word & PDF</li>
                        </ul>
                    </div>
                    <div class="text-center">
                        <h4 class="font-semibold mb-2">üìñ Kurikulum</h4>
                        <ul class="text-sm text-gray-300 space-y-1">
                            <li>Kurikulum Merdeka</li>
                            <li>Profil Pelajar Pancasila</li>
                            <li>Deep Learning Approach</li>
                        </ul>
                    </div>
                    <div class="text-center">
                        <h4 class="font-semibold mb-2">üí° Manfaat</h4>
                        <ul class="text-sm text-gray-300 space-y-1">
                            <li>Hemat waktu persiapan</li>
                            <li>Modul berkualitas tinggi</li>
                            <li>Sesuai standar pendidikan</li>
                        </ul>
                    </div>
                </div>
                
                <div class="border-t border-gray-700 pt-6 text-center">
                    <p class="text-gray-400 text-sm mb-2">
                        ¬© 2024 Dashboard Pembuat Modul Ajar. Dibuat dengan ‚ù§Ô∏è untuk kemajuan pendidikan Indonesia.
                    </p>
                    <p class="text-gray-500 text-xs">
                        Hak Cipta Dilindungi | Semua fitur dirancang untuk membantu guru Indonesia menciptakan pembelajaran berkualitas
                    </p>
                    <div class="mt-3 text-xs text-gray-500">
                        <span class="inline-block mx-2">üåü Inovasi Pendidikan</span>
                        <span class="inline-block mx-2">üöÄ Teknologi AI</span>
                        <span class="inline-block mx-2">üéì Untuk Guru Indonesia</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Fungsi untuk download sebagai Word
        function downloadAsWord(topik, mapel, kelas) {
            // Ambil data form untuk membuat dokumen terstruktur
            const formData = getFormData();
            const fileName = `Modul_Ajar_${topik.replace(/\s+/g, '_')}_${mapel.replace(/\s+/g, '_')}_${kelas.replace(/\s+/g, '_')}.doc`;
            
            const htmlContent = `
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>Modul Ajar - ${topik}</title>
                    <style>
                        body { font-family: 'Times New Roman', serif; margin: 30px; line-height: 1.6; font-size: 12pt; }
                        h1 { color: #000; text-align: center; font-size: 16pt; font-weight: bold; margin-bottom: 20px; }
                        h2 { color: #000; font-size: 14pt; font-weight: bold; margin-top: 25px; margin-bottom: 10px; }
                        h3 { color: #000; font-size: 12pt; font-weight: bold; margin-top: 20px; margin-bottom: 8px; }
                        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; vertical-align: top; }
                        th { background-color: #f0f0f0; font-weight: bold; text-align: center; }
                        .header-table { margin-bottom: 25px; }
                        .header-table td { padding: 5px 10px; }
                        .no-border { border: none; }
                        .center { text-align: center; }
                        .bold { font-weight: bold; }
                        ul { margin: 5px 0; padding-left: 20px; }
                        li { margin-bottom: 3px; }
                        .section { margin: 20px 0; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #000; font-style: italic; color: #666; font-size: 10pt; }
                    </style>
                </head>
                <body>
                    <h1>MODUL AJAR</h1>
                    
                    <table class="header-table">
                        <tr>
                            <td class="bold" style="width: 25%;">Penyusun</td>
                            <td style="width: 2%;">:</td>
                            <td>${formData.penyusun || '................................'}</td>
                            <td class="bold" style="width: 25%;">Tahun Pelajaran</td>
                            <td style="width: 2%;">:</td>
                            <td>${formData.tahun || '................................'}</td>
                        </tr>
                        <tr>
                            <td class="bold">Satuan Pendidikan</td>
                            <td>:</td>
                            <td>${formData.satuan || '................................'}</td>
                            <td class="bold">Semester</td>
                            <td>:</td>
                            <td>${formData.semester ? 'Semester ' + formData.semester : '................................'}</td>
                        </tr>
                        <tr>
                            <td class="bold">Mata Pelajaran</td>
                            <td>:</td>
                            <td>${formData.mapel || '................................'}</td>
                            <td class="bold">Kelas/Fase</td>
                            <td>:</td>
                            <td>${formData.kelas || '................................'}</td>
                        </tr>
                        <tr>
                            <td class="bold">Topik/Elemen</td>
                            <td>:</td>
                            <td>${formData.topik || '................................'}</td>
                            <td class="bold">Alokasi Waktu</td>
                            <td>:</td>
                            <td>${formData.alokasi || '................................'}</td>
                        </tr>
                    </table>

                    <div class="section">
                        <h2>A. CAPAIAN PEMBELAJARAN</h2>
                        <p>${formData.capaian || 'Belum diisi - silakan lengkapi sesuai kurikulum yang berlaku'}</p>
                    </div>

                    <div class="section">
                        <h2>B. TUJUAN PEMBELAJARAN</h2>
                        <p>${formData.tujuan || 'Belum diisi - silakan lengkapi dengan tujuan pembelajaran yang spesifik'}</p>
                    </div>

                    <div class="section">
                        <h2>C. DIMENSI PROFIL PELAJAR PANCASILA</h2>
                        <ul>
                            ${getDimensiList().map(d => `<li>${d}</li>`).join('')}
                        </ul>
                    </div>

                    <div class="section">
                        <h2>D. MODEL DAN PENDEKATAN PEMBELAJARAN</h2>
                        <table>
                            <tr>
                                <td class="bold" style="width: 30%;">Model Pembelajaran</td>
                                <td>:</td>
                                <td>${formData.model || 'Belum dipilih'}</td>
                            </tr>
                            <tr>
                                <td class="bold">Pendekatan Pembelajaran</td>
                                <td>:</td>
                                <td>${formData.pendekatan || 'Belum dipilih'}</td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2>E. SARANA DAN PRASARANA</h2>
                        <p>${formData.sarana || 'Belum diisi - silakan lengkapi dengan sarana dan prasarana yang dibutuhkan'}</p>
                    </div>

                    <div class="section">
                        <h2>F. SUMBER BELAJAR</h2>
                        <p>${formData.sumber || 'Belum diisi - silakan lengkapi dengan sumber belajar yang akan digunakan'}</p>
                    </div>

                    ${formData.digital ? `
                    <div class="section">
                        <h2>G. PEMANFAATAN TEKNOLOGI DIGITAL</h2>
                        <p>${formData.digital}</p>
                    </div>
                    ` : ''}

                    <div class="section">
                        <h2>H. PERTANYAAN PEMANTIK</h2>
                        <ol>
                            <li>Mengapa konsep ${formData.topik || '[topik]'} penting untuk dipahami dalam ${formData.mapel || '[mata pelajaran]'}?</li>
                            <li>Bagaimana ${formData.topik || '[topik]'} terhubung dengan kehidupan sehari-hari kalian?</li>
                            <li>Apa yang terjadi jika kita tidak memahami ${formData.topik || '[topik]'} dengan baik?</li>
                            <li>Bagaimana ${formData.topik || '[topik]'} dapat membantu kalian di masa depan?</li>
                        </ol>
                    </div>

                    <div class="section">
                        <h2>I. LANGKAH-LANGKAH PEMBELAJARAN</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 15%;">Tahapan</th>
                                    <th style="width: 15%;">Waktu</th>
                                    <th style="width: 35%;">Kegiatan Guru</th>
                                    <th style="width: 35%;">Kegiatan Siswa</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="bold center">PENDAHULUAN</td>
                                    <td class="center">${calculateTime(formData.alokasi, 0.15)} menit</td>
                                    <td>
                                        <ul>
                                            <li>Membuka pembelajaran dengan salam dan doa</li>
                                            <li>Mengecek kehadiran siswa</li>
                                            <li>Melakukan apersepsi dengan mengaitkan materi sebelumnya</li>
                                            <li>Menyampaikan tujuan pembelajaran</li>
                                            <li>Memberikan motivasi melalui pertanyaan pemantik</li>
                                            <li>Melakukan asesmen diagnostik</li>
                                        </ul>
                                    </td>
                                    <td>
                                        <ul>
                                            <li>Menjawab salam dan berdoa</li>
                                            <li>Merespon pengecekan kehadiran</li>
                                            <li>Mendengarkan apersepsi dan mengaitkan dengan pengalaman</li>
                                            <li>Memperhatikan tujuan pembelajaran</li>
                                            <li>Merespon pertanyaan pemantik</li>
                                            <li>Mengikuti asesmen diagnostik</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold center">KEGIATAN INTI</td>
                                    <td class="center">${calculateTime(formData.alokasi, 0.70)} menit</td>
                                    <td>
                                        <ul>
                                            <li><strong>Fase 1 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit):</strong> Orientasi pada masalah/topik ${formData.topik || '[topik]'}</li>
                                            <li>Menyajikan fenomena atau masalah kontekstual</li>
                                            <li>Membimbing siswa mengidentifikasi masalah</li>
                                            <li>Membentuk kelompok belajar</li>
                                            <li><strong>Fase 2 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit):</strong> Mengorganisasi siswa untuk belajar</li>
                                            <li>Membantu siswa merumuskan hipotesis</li>
                                            <li>Membagi tugas dalam kelompok</li>
                                            <li>Menjelaskan strategi pemecahan masalah</li>
                                            <li><strong>Fase 3 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.30)} menit):</strong> Membimbing penyelidikan</li>
                                            <li>Memfasilitasi pengumpulan informasi</li>
                                            <li>Membimbing eksperimen atau analisis</li>
                                            <li>Memberikan scaffolding sesuai kebutuhan</li>
                                            <li><strong>Fase 4 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.20)} menit):</strong> Presentasi hasil</li>
                                            <li>Memfasilitasi presentasi kelompok</li>
                                            <li>Memberikan umpan balik konstruktif</li>
                                            <li>Mengarahkan diskusi antar kelompok</li>
                                        </ul>
                                    </td>
                                    <td>
                                        <ul>
                                            <li><strong>Fase 1:</strong> Mengamati fenomena/masalah</li>
                                            <li>Mengidentifikasi masalah yang akan dipecahkan</li>
                                            <li>Bergabung dalam kelompok yang ditentukan</li>
                                            <li>Menggunakan teknologi digital jika tersedia</li>
                                            <li><strong>Fase 2:</strong> Merumuskan hipotesis</li>
                                            <li>Membagi tugas dalam kelompok</li>
                                            <li>Menentukan strategi pemecahan masalah</li>
                                            <li>Berkolaborasi dalam kelompok</li>
                                            <li><strong>Fase 3:</strong> Mengumpulkan informasi</li>
                                            <li>Melakukan eksperimen atau analisis data</li>
                                            <li>Berdiskusi dan berkolaborasi</li>
                                            <li>Mencatat temuan dan hasil investigasi</li>
                                            <li><strong>Fase 4:</strong> Mempresentasikan hasil</li>
                                            <li>Mendengarkan presentasi kelompok lain</li>
                                            <li>Mengajukan pertanyaan dan memberikan tanggapan</li>
                                            <li>Merefleksikan pembelajaran</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold center">PENUTUP</td>
                                    <td class="center">${calculateTime(formData.alokasi, 0.15)} menit</td>
                                    <td>
                                        <ul>
                                            <li>Memfasilitasi refleksi pembelajaran</li>
                                            <li>Membimbing siswa membuat kesimpulan</li>
                                            <li>Melakukan asesmen formatif</li>
                                            <li>Memberikan penguatan dan apresiasi</li>
                                            <li>Menyampaikan rencana pembelajaran berikutnya</li>
                                            <li>Menutup pembelajaran dengan doa</li>
                                        </ul>
                                    </td>
                                    <td>
                                        <ul>
                                            <li>Melakukan refleksi pembelajaran</li>
                                            <li>Menyampaikan kesimpulan pembelajaran</li>
                                            <li>Mengikuti asesmen formatif</li>
                                            <li>Mendengarkan penguatan dari guru</li>
                                            <li>Memperhatikan rencana pembelajaran berikutnya</li>
                                            <li>Berdoa penutup</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="section">
                        <h2>J. STRATEGI PEMBELAJARAN BERDIFERENSIASI</h2>
                        <table>
                            <tr>
                                <th style="width: 25%;">Jenis Diferensiasi</th>
                                <th>Strategi Implementasi</th>
                            </tr>
                            <tr>
                                <td class="bold">Diferensiasi Konten</td>
                                <td>
                                    <ul>
                                        ${getDifferentiationContent().konten.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td class="bold">Diferensiasi Proses</td>
                                <td>
                                    <ul>
                                        ${getDifferentiationContent().proses.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td class="bold">Diferensiasi Produk</td>
                                <td>
                                    <ul>
                                        ${getDifferentiationContent().produk.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2>K. ASESMEN PEMBELAJARAN</h2>
                        <table>
                            <tr>
                                <th style="width: 20%;">Jenis Asesmen</th>
                                <th style="width: 30%;">Bentuk Asesmen</th>
                                <th>Deskripsi</th>
                            </tr>
                            <tr>
                                <td class="bold">Asesmen Diagnostik</td>
                                <td>
                                    <ul>
                                        <li>Tes awal pemahaman</li>
                                        <li>Pemetaan konsep</li>
                                        <li>Kuesioner kesiapan belajar</li>
                                    </ul>
                                </td>
                                <td>Mengukur pengetahuan awal dan kesiapan siswa sebelum pembelajaran dimulai</td>
                            </tr>
                            <tr>
                                <td class="bold">Asesmen Formatif</td>
                                <td>
                                    <ul>
                                        <li>Observasi selama pembelajaran</li>
                                        <li>Diskusi kelompok</li>
                                        <li>Pertanyaan lisan</li>
                                        <li>Exit ticket</li>
                                    </ul>
                                </td>
                                <td>Memantau kemajuan belajar siswa selama proses pembelajaran berlangsung</td>
                            </tr>
                            <tr>
                                <td class="bold">Asesmen Sumatif</td>
                                <td>
                                    <ul>
                                        <li>Tes tertulis</li>
                                        <li>Presentasi kelompok</li>
                                        <li>Proyek individu</li>
                                        <li>Portfolio</li>
                                    </ul>
                                </td>
                                <td>Mengevaluasi pencapaian tujuan pembelajaran di akhir pembelajaran</td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2>L. PROGRAM REMEDIAL DAN PENGAYAAN</h2>
                        <table>
                            <tr>
                                <th style="width: 20%;">Program</th>
                                <th style="width: 30%;">Target Siswa</th>
                                <th>Strategi</th>
                            </tr>
                            <tr>
                                <td class="bold">Remedial</td>
                                <td>Siswa yang belum mencapai KKM dalam pemahaman ${formData.topik || '[topik]'}</td>
                                <td>
                                    <ul>
                                        <li>Pembelajaran individual dengan pendampingan intensif</li>
                                        <li>Penggunaan media pembelajaran yang lebih konkret</li>
                                        <li>Pemberian contoh-contoh sederhana dan bertahap</li>
                                        <li>Peer tutoring dengan siswa yang sudah tuntas</li>
                                        <li>Tes ulang dengan soal setara namun berbeda konteks</li>
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td class="bold">Pengayaan</td>
                                <td>Siswa yang sudah mencapai KKM dan menunjukkan minat tinggi pada ${formData.topik || '[topik]'}</td>
                                <td>
                                    <ul>
                                        <li>Proyek penelitian mini terkait aplikasi lanjut</li>
                                        <li>Menjadi tutor sebaya untuk teman yang membutuhkan</li>
                                        <li>Eksplorasi topik lanjutan atau lintas bidang</li>
                                        <li>Presentasi hasil eksplorasi kepada kelas</li>
                                        <li>Portfolio proyek pengayaan</li>
                                    </ul>
                                </td>
                            </tr>
                        </table>
                    </div>

                    ${formData.lintas ? `
                    <div class="section">
                        <h2>M. LINTAS BIDANG DISIPLIN ILMU</h2>
                        <p>${formData.lintas}</p>
                    </div>
                    ` : ''}

                    <div class="footer">
                        <hr>
                        <p class="center"><strong>Catatan:</strong></p>
                        <p>Modul ajar ini dibuat menggunakan Dashboard Pembuat Modul Ajar dengan bantuan teknologi AI. Silakan disesuaikan dengan kondisi siswa, sarana prasarana, dan karakteristik sekolah masing-masing.</p>
                        <p class="center" style="margin-top: 20px;">
                            <em>¬© 2024 Dashboard Pembuat Modul Ajar - Untuk Kemajuan Pendidikan Indonesia</em>
                        </p>
                    </div>
                </body>
                </html>
            `;
            
            const blob = new Blob([htmlContent], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('‚úÖ File Word berhasil didownload! Format terstruktur dan siap diedit.', 'success');
        }

        // Fungsi untuk download sebagai PDF (format teks terstruktur)
        function downloadAsPDF(topik, mapel, kelas) {
            const formData = getFormData();
            const fileName = `Modul_Ajar_${topik.replace(/\s+/g, '_')}_${mapel.replace(/\s+/g, '_')}_${kelas.replace(/\s+/g, '_')}.txt`;
            
            const textContent = `
MODUL AJAR
${topik.toUpperCase()} - ${mapel.toUpperCase()} - KELAS ${kelas.toUpperCase()}
${'='.repeat(80)}

IDENTITAS MODUL AJAR
${'='.repeat(80)}
Penyusun             : ${formData.penyusun || '................................'}
Satuan Pendidikan    : ${formData.satuan || '................................'}
Mata Pelajaran       : ${formData.mapel || '................................'}
Kelas/Fase           : ${formData.kelas || '................................'}
Topik/Elemen         : ${formData.topik || '................................'}
Tahun Pelajaran      : ${formData.tahun || '................................'}
Semester             : ${formData.semester ? 'Semester ' + formData.semester : '................................'}
Alokasi Waktu        : ${formData.alokasi || '................................'}

A. CAPAIAN PEMBELAJARAN
${'='.repeat(80)}
${formData.capaian || 'Belum diisi - silakan lengkapi sesuai kurikulum yang berlaku'}

B. TUJUAN PEMBELAJARAN
${'='.repeat(80)}
${formData.tujuan || 'Belum diisi - silakan lengkapi dengan tujuan pembelajaran yang spesifik'}

C. DIMENSI PROFIL PELAJAR PANCASILA
${'='.repeat(80)}
${getDimensiList().map((d, i) => `${i + 1}. ${d}`).join('\n')}

D. MODEL DAN PENDEKATAN PEMBELAJARAN
${'='.repeat(80)}
Model Pembelajaran      : ${formData.model || 'Belum dipilih'}
Pendekatan Pembelajaran : ${formData.pendekatan || 'Belum dipilih'}

E. SARANA DAN PRASARANA
${'='.repeat(80)}
${formData.sarana || 'Belum diisi - silakan lengkapi dengan sarana dan prasarana yang dibutuhkan'}

F. SUMBER BELAJAR
${'='.repeat(80)}
${formData.sumber || 'Belum diisi - silakan lengkapi dengan sumber belajar yang akan digunakan'}

${formData.digital ? `G. PEMANFAATAN TEKNOLOGI DIGITAL
${'='.repeat(80)}
${formData.digital}

` : ''}H. PERTANYAAN PEMANTIK
${'='.repeat(80)}
1. Mengapa konsep ${formData.topik || '[topik]'} penting untuk dipahami dalam ${formData.mapel || '[mata pelajaran]'}?
2. Bagaimana ${formData.topik || '[topik]'} terhubung dengan kehidupan sehari-hari kalian?
3. Apa yang terjadi jika kita tidak memahami ${formData.topik || '[topik]'} dengan baik?
4. Bagaimana ${formData.topik || '[topik]'} dapat membantu kalian di masa depan?

I. LANGKAH-LANGKAH PEMBELAJARAN
${'='.repeat(80)}

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TAHAPAN         ‚îÇ WAKTU       ‚îÇ KEGIATAN PEMBELAJARAN                                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ PENDAHULUAN     ‚îÇ ${calculateTime(formData.alokasi, 0.15)} menit     ‚îÇ KEGIATAN GURU:                                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membuka pembelajaran dengan salam dan doa                         ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mengecek kehadiran siswa                                          ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Melakukan apersepsi dengan mengaitkan materi sebelumnya          ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menyampaikan tujuan pembelajaran                                  ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memberikan motivasi melalui pertanyaan pemantik                  ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Melakukan asesmen diagnostik                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ KEGIATAN SISWA:                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menjawab salam dan berdoa                                         ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Merespon pengecekan kehadiran                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mendengarkan apersepsi dan mengaitkan dengan pengalaman          ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memperhatikan tujuan pembelajaran                                 ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Merespon pertanyaan pemantik                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mengikuti asesmen diagnostik                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ KEGIATAN INTI   ‚îÇ ${calculateTime(formData.alokasi, 0.70)} menit     ‚îÇ KEGIATAN GURU:                                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ FASE 1 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit): Orientasi pada masalah/topik ${formData.topik || '[topik]'}      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menyajikan fenomena atau masalah kontekstual                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membimbing siswa mengidentifikasi masalah                         ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membentuk kelompok belajar                                        ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ FASE 2 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit): Mengorganisasi siswa untuk belajar              ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membantu siswa merumuskan hipotesis                               ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membagi tugas dalam kelompok                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menjelaskan strategi pemecahan masalah                            ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ FASE 3 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.30)} menit): Membimbing penyelidikan                        ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memfasilitasi pengumpulan informasi                               ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membimbing eksperimen atau analisis                               ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memberikan scaffolding sesuai kebutuhan                           ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ FASE 4 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.20)} menit): Presentasi hasil                              ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memfasilitasi presentasi kelompok                                 ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memberikan umpan balik konstruktif                                ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mengarahkan diskusi antar kelompok                                ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ KEGIATAN SISWA:                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ FASE 1: Mengamati fenomena/masalah, mengidentifikasi masalah,     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ   bergabung dalam kelompok, menggunakan teknologi digital          ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ FASE 2: Merumuskan hipotesis, membagi tugas dalam kelompok,      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ   menentukan strategi pemecahan masalah, berkolaborasi             ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ FASE 3: Mengumpulkan informasi, melakukan eksperimen/analisis,   ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ   berdiskusi dan berkolaborasi, mencatat temuan                    ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ FASE 4: Mempresentasikan hasil, mendengarkan presentasi lain,    ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ   mengajukan pertanyaan, merefleksikan pembelajaran                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ PENUTUP         ‚îÇ ${calculateTime(formData.alokasi, 0.15)} menit     ‚îÇ KEGIATAN GURU:                                                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memfasilitasi refleksi pembelajaran                               ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Membimbing siswa membuat kesimpulan                               ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Melakukan asesmen formatif                                        ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memberikan penguatan dan apresiasi                                ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menyampaikan rencana pembelajaran berikutnya                      ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menutup pembelajaran dengan doa                                   ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ                                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ KEGIATAN SISWA:                                                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Melakukan refleksi pembelajaran                                   ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Menyampaikan kesimpulan pembelajaran                              ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mengikuti asesmen formatif                                        ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Mendengarkan penguatan dari guru                                  ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Memperhatikan rencana pembelajaran berikutnya                     ‚îÇ
‚îÇ                 ‚îÇ             ‚îÇ ‚Ä¢ Berdoa penutup                                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

J. STRATEGI PEMBELAJARAN BERDIFERENSIASI
${'='.repeat(80)}

1. DIFERENSIASI KONTEN:
${getDifferentiationContent().konten.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

2. DIFERENSIASI PROSES:
${getDifferentiationContent().proses.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

3. DIFERENSIASI PRODUK:
${getDifferentiationContent().produk.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

K. ASESMEN PEMBELAJARAN
${'='.repeat(80)}

1. ASESMEN DIAGNOSTIK:
   ‚Ä¢ Tes awal pemahaman
   ‚Ä¢ Pemetaan konsep
   ‚Ä¢ Kuesioner kesiapan belajar
   Tujuan: Mengukur pengetahuan awal dan kesiapan siswa sebelum pembelajaran

2. ASESMEN FORMATIF:
   ‚Ä¢ Observasi selama pembelajaran
   ‚Ä¢ Diskusi kelompok
   ‚Ä¢ Pertanyaan lisan
   ‚Ä¢ Exit ticket
   Tujuan: Memantau kemajuan belajar siswa selama proses pembelajaran

3. ASESMEN SUMATIF:
   ‚Ä¢ Tes tertulis
   ‚Ä¢ Presentasi kelompok
   ‚Ä¢ Proyek individu
   ‚Ä¢ Portfolio
   Tujuan: Mengevaluasi pencapaian tujuan pembelajaran di akhir pembelajaran

L. PROGRAM REMEDIAL DAN PENGAYAAN
${'='.repeat(80)}

1. PROGRAM REMEDIAL:
   Target: Siswa yang belum mencapai KKM dalam pemahaman ${formData.topik || '[topik]'}
   Strategi:
   ‚Ä¢ Pembelajaran individual dengan pendampingan intensif
   ‚Ä¢ Penggunaan media pembelajaran yang lebih konkret
   ‚Ä¢ Pemberian contoh-contoh sederhana dan bertahap
   ‚Ä¢ Peer tutoring dengan siswa yang sudah tuntas
   ‚Ä¢ Tes ulang dengan soal setara namun berbeda konteks

2. PROGRAM PENGAYAAN:
   Target: Siswa yang sudah mencapai KKM dan menunjukkan minat tinggi pada ${formData.topik || '[topik]'}
   Strategi:
   ‚Ä¢ Proyek penelitian mini terkait aplikasi lanjut
   ‚Ä¢ Menjadi tutor sebaya untuk teman yang membutuhkan
   ‚Ä¢ Eksplorasi topik lanjutan atau lintas bidang
   ‚Ä¢ Presentasi hasil eksplorasi kepada kelas
   ‚Ä¢ Portfolio proyek pengayaan

${formData.lintas ? `M. LINTAS BIDANG DISIPLIN ILMU
${'='.repeat(80)}
${formData.lintas}

` : ''}${'='.repeat(80)}
CATATAN PENTING
${'='.repeat(80)}

Modul ajar ini dibuat menggunakan Dashboard Pembuat Modul Ajar dengan bantuan 
teknologi AI. Silakan disesuaikan dengan kondisi siswa, sarana prasarana, dan 
karakteristik sekolah masing-masing.

Tanggal Pembuatan: ${new Date().toLocaleDateString('id-ID')}
Waktu Pembuatan  : ${new Date().toLocaleTimeString('id-ID')}

¬© 2024 Dashboard Pembuat Modul Ajar - Untuk Kemajuan Pendidikan Indonesia
${'='.repeat(80)}
            `;
            
            const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('‚úÖ File teks terstruktur berhasil didownload! Siap diconvert ke PDF.', 'success');
        }

        // Fungsi untuk copy ke clipboard
        function copyToClipboard() {
            const formData = getFormData();
            const fullContent = `
MODUL AJAR
${formData.topik ? formData.topik.toUpperCase() : '[TOPIK]'} - ${formData.mapel ? formData.mapel.toUpperCase() : '[MATA PELAJARAN]'} - KELAS ${formData.kelas ? formData.kelas.toUpperCase() : '[KELAS]'}
================================================================================

IDENTITAS MODUL AJAR
================================================================================
Penyusun             : ${formData.penyusun || '................................'}
Satuan Pendidikan    : ${formData.satuan || '................................'}
Mata Pelajaran       : ${formData.mapel || '................................'}
Kelas/Fase           : ${formData.kelas || '................................'}
Topik/Elemen         : ${formData.topik || '................................'}
Tahun Pelajaran      : ${formData.tahun || '................................'}
Semester             : ${formData.semester ? 'Semester ' + formData.semester : '................................'}
Alokasi Waktu        : ${formData.alokasi || '................................'}

A. CAPAIAN PEMBELAJARAN
================================================================================
${formData.capaian || 'Belum diisi - silakan lengkapi sesuai kurikulum yang berlaku'}

B. TUJUAN PEMBELAJARAN
================================================================================
${formData.tujuan || 'Belum diisi - silakan lengkapi dengan tujuan pembelajaran yang spesifik'}

C. DIMENSI PROFIL PELAJAR PANCASILA
================================================================================
${getDimensiList().map((d, i) => `${i + 1}. ${d}`).join('\n')}

D. MODEL DAN PENDEKATAN PEMBELAJARAN
================================================================================
Model Pembelajaran      : ${formData.model || 'Belum dipilih'}
Pendekatan Pembelajaran : ${formData.pendekatan || 'Belum dipilih'}

E. SARANA DAN PRASARANA
================================================================================
${formData.sarana || 'Belum diisi - silakan lengkapi dengan sarana dan prasarana yang dibutuhkan'}

F. SUMBER BELAJAR
================================================================================
${formData.sumber || 'Belum diisi - silakan lengkapi dengan sumber belajar yang akan digunakan'}

${formData.digital ? `G. PEMANFAATAN TEKNOLOGI DIGITAL
================================================================================
${formData.digital}

` : ''}H. PERTANYAAN PEMANTIK
================================================================================
1. Mengapa konsep ${formData.topik || '[topik]'} penting untuk dipahami dalam ${formData.mapel || '[mata pelajaran]'}?
2. Bagaimana ${formData.topik || '[topik]'} terhubung dengan kehidupan sehari-hari kalian?
3. Apa yang terjadi jika kita tidak memahami ${formData.topik || '[topik]'} dengan baik?
4. Bagaimana ${formData.topik || '[topik]'} dapat membantu kalian di masa depan?

I. LANGKAH-LANGKAH PEMBELAJARAN
================================================================================

TAHAPAN PEMBELAJARAN:

1. PENDAHULUAN (${calculateTime(formData.alokasi, 0.15)} menit)
   KEGIATAN GURU:
   ‚Ä¢ Membuka pembelajaran dengan salam dan doa
   ‚Ä¢ Mengecek kehadiran siswa
   ‚Ä¢ Melakukan apersepsi dengan mengaitkan materi sebelumnya
   ‚Ä¢ Menyampaikan tujuan pembelajaran
   ‚Ä¢ Memberikan motivasi melalui pertanyaan pemantik
   ‚Ä¢ Melakukan asesmen diagnostik

   KEGIATAN SISWA:
   ‚Ä¢ Menjawab salam dan berdoa
   ‚Ä¢ Merespon pengecekan kehadiran
   ‚Ä¢ Mendengarkan apersepsi dan mengaitkan dengan pengalaman
   ‚Ä¢ Memperhatikan tujuan pembelajaran
   ‚Ä¢ Merespon pertanyaan pemantik
   ‚Ä¢ Mengikuti asesmen diagnostik

2. KEGIATAN INTI (${calculateTime(formData.alokasi, 0.70)} menit)
   FASE 1 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit): Orientasi pada masalah/topik ${formData.topik || '[topik]'}
   KEGIATAN GURU:
   ‚Ä¢ Menyajikan fenomena atau masalah kontekstual
   ‚Ä¢ Membimbing siswa mengidentifikasi masalah
   ‚Ä¢ Membentuk kelompok belajar

   KEGIATAN SISWA:
   ‚Ä¢ Mengamati fenomena/masalah
   ‚Ä¢ Mengidentifikasi masalah yang akan dipecahkan
   ‚Ä¢ Bergabung dalam kelompok yang ditentukan

   FASE 2 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.25)} menit): Mengorganisasi siswa untuk belajar
   KEGIATAN GURU:
   ‚Ä¢ Membantu siswa merumuskan hipotesis
   ‚Ä¢ Membagi tugas dalam kelompok
   ‚Ä¢ Menjelaskan strategi pemecahan masalah

   KEGIATAN SISWA:
   ‚Ä¢ Merumuskan hipotesis
   ‚Ä¢ Membagi tugas dalam kelompok
   ‚Ä¢ Menentukan strategi pemecahan masalah

   FASE 3 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.30)} menit): Membimbing penyelidikan
   KEGIATAN GURU:
   ‚Ä¢ Memfasilitasi pengumpulan informasi
   ‚Ä¢ Membimbing eksperimen atau analisis
   ‚Ä¢ Memberikan scaffolding sesuai kebutuhan

   KEGIATAN SISWA:
   ‚Ä¢ Mengumpulkan informasi
   ‚Ä¢ Melakukan eksperimen atau analisis data
   ‚Ä¢ Berdiskusi dan berkolaborasi

   FASE 4 (${Math.round(calculateTime(formData.alokasi, 0.70) * 0.20)} menit): Presentasi hasil
   KEGIATAN GURU:
   ‚Ä¢ Memfasilitasi presentasi kelompok
   ‚Ä¢ Memberikan umpan balik konstruktif
   ‚Ä¢ Mengarahkan diskusi antar kelompok

   KEGIATAN SISWA:
   ‚Ä¢ Mempresentasikan hasil
   ‚Ä¢ Mendengarkan presentasi kelompok lain
   ‚Ä¢ Mengajukan pertanyaan dan memberikan tanggapan

3. PENUTUP (${calculateTime(formData.alokasi, 0.15)} menit)
   KEGIATAN GURU:
   ‚Ä¢ Memfasilitasi refleksi pembelajaran
   ‚Ä¢ Membimbing siswa membuat kesimpulan
   ‚Ä¢ Melakukan asesmen formatif
   ‚Ä¢ Memberikan penguatan dan apresiasi
   ‚Ä¢ Menyampaikan rencana pembelajaran berikutnya
   ‚Ä¢ Menutup pembelajaran dengan doa

   KEGIATAN SISWA:
   ‚Ä¢ Melakukan refleksi pembelajaran
   ‚Ä¢ Menyampaikan kesimpulan pembelajaran
   ‚Ä¢ Mengikuti asesmen formatif
   ‚Ä¢ Mendengarkan penguatan dari guru
   ‚Ä¢ Memperhatikan rencana pembelajaran berikutnya
   ‚Ä¢ Berdoa penutup

J. STRATEGI PEMBELAJARAN BERDIFERENSIASI
================================================================================
1. DIFERENSIASI KONTEN:
${getDifferentiationContent().konten.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

2. DIFERENSIASI PROSES:
${getDifferentiationContent().proses.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

3. DIFERENSIASI PRODUK:
${getDifferentiationContent().produk.map((item, i) => `   ${i + 1}. ${item}`).join('\n')}

K. ASESMEN PEMBELAJARAN
================================================================================
1. ASESMEN DIAGNOSTIK:
   ‚Ä¢ Tes awal pemahaman
   ‚Ä¢ Pemetaan konsep
   ‚Ä¢ Kuesioner kesiapan belajar

2. ASESMEN FORMATIF:
   ‚Ä¢ Observasi selama pembelajaran
   ‚Ä¢ Diskusi kelompok
   ‚Ä¢ Pertanyaan lisan
   ‚Ä¢ Exit ticket

3. ASESMEN SUMATIF:
   ‚Ä¢ Tes tertulis
   ‚Ä¢ Presentasi kelompok
   ‚Ä¢ Proyek individu
   ‚Ä¢ Portfolio

L. PROGRAM REMEDIAL DAN PENGAYAAN
================================================================================
1. PROGRAM REMEDIAL:
   Target: Siswa yang belum mencapai KKM dalam pemahaman ${formData.topik || '[topik]'}
   Strategi:
   ‚Ä¢ Pembelajaran individual dengan pendampingan intensif
   ‚Ä¢ Penggunaan media pembelajaran yang lebih konkret
   ‚Ä¢ Pemberian contoh-contoh sederhana dan bertahap
   ‚Ä¢ Peer tutoring dengan siswa yang sudah tuntas

2. PROGRAM PENGAYAAN:
   Target: Siswa yang sudah mencapai KKM dan menunjukkan minat tinggi pada ${formData.topik || '[topik]'}
   Strategi:
   ‚Ä¢ Proyek penelitian mini terkait aplikasi lanjut
   ‚Ä¢ Menjadi tutor sebaya untuk teman yang membutuhkan
   ‚Ä¢ Eksplorasi topik lanjutan atau lintas bidang
   ‚Ä¢ Presentasi hasil eksplorasi kepada kelas

${formData.lintas ? `M. LINTAS BIDANG DISIPLIN ILMU
================================================================================
${formData.lintas}

` : ''}================================================================================
CATATAN PENTING
================================================================================
Modul ajar ini dibuat menggunakan Dashboard Pembuat Modul Ajar dengan bantuan 
teknologi AI. Silakan disesuaikan dengan kondisi siswa, sarana prasarana, dan 
karakteristik sekolah masing-masing.

Tanggal: ${new Date().toLocaleDateString('id-ID')}
¬© 2024 Dashboard Pembuat Modul Ajar - Untuk Kemajuan Pendidikan Indonesia
================================================================================
            `;
            
            navigator.clipboard.writeText(fullContent).then(() => {
                showNotification('‚úÖ Modul ajar berhasil disalin ke clipboard! Siap untuk dipaste ke aplikasi lain.', 'success');
            }).catch(() => {
                // Fallback untuk browser yang tidak support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = fullContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('‚úÖ Modul ajar berhasil disalin ke clipboard!', 'success');
            });
        }

        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg text-white font-semibold transition-all duration-300 max-w-sm ${
                type === 'success' ? 'bg-green-600' : 'bg-red-600'
            }`;
            notification.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-1">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (notification.parentElement) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Fungsi helper untuk mengambil data form
        function getFormData() {
            return {
                penyusun: document.getElementById('penyusun').value,
                satuan: document.getElementById('satuan').value,
                tahun: document.getElementById('tahun').value,
                semester: document.getElementById('semester').value,
                mapel: document.getElementById('mapel').value,
                kelas: document.getElementById('kelas').value,
                topik: document.getElementById('topik').value,
                alokasi: document.getElementById('alokasi').value,
                sarana: document.getElementById('sarana').value,
                capaian: document.getElementById('capaian').value,
                tujuan: document.getElementById('tujuan').value,
                lintas: document.getElementById('lintas').value,
                sumber: document.getElementById('sumber').value,
                model: document.getElementById('model').value,
                pendekatan: document.getElementById('pendekatan').value,
                digital: document.getElementById('digital').value
            };
        }

        // Fungsi helper untuk menghitung waktu
        function calculateTime(alokasi, percentage) {
            if (!alokasi) return 15; // default
            const waktuMatch = alokasi.match(/(\d+)/g);
            const totalMenit = waktuMatch ? parseInt(waktuMatch[0]) * parseInt(waktuMatch[1] || 45) : 90;
            return Math.round(totalMenit * percentage);
        }

        // Fungsi helper untuk mendapatkan daftar dimensi
        function getDimensiList() {
            const dimensiChecked = Array.from(document.querySelectorAll('input[name="dimensi"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);
            return dimensiChecked.length > 0 ? dimensiChecked : ['Belum ada dimensi yang dipilih'];
        }

        // Fungsi helper untuk mendapatkan konten diferensiasi
        function getDifferentiationContent() {
            const diferensiasiKonten = Array.from(document.querySelectorAll('input[name="diferensiasi_konten"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);
            const diferensiasiProses = Array.from(document.querySelectorAll('input[name="diferensiasi_proses"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);
            const diferensiasiProduk = Array.from(document.querySelectorAll('input[name="diferensiasi_produk"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);

            return {
                konten: diferensiasiKonten.length > 0 ? diferensiasiKonten : ['Materi dengan tingkat kompleksitas berbeda', 'Sumber belajar beragam sesuai kebutuhan siswa'],
                proses: diferensiasiProses.length > 0 ? diferensiasiProses : ['Kelompok heterogen dan homogen', 'Scaffolding sesuai kebutuhan siswa'],
                produk: diferensiasiProduk.length > 0 ? diferensiasiProduk : ['Format tugas beragam sesuai kemampuan', 'Rubrik penilaian yang fleksibel']
            };
        }

        document.getElementById('modulForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Ambil semua data form
            const formData = {
                penyusun: document.getElementById('penyusun').value,
                satuan: document.getElementById('satuan').value,
                tahun: document.getElementById('tahun').value,
                semester: document.getElementById('semester').value,
                mapel: document.getElementById('mapel').value,
                kelas: document.getElementById('kelas').value,
                topik: document.getElementById('topik').value,
                alokasi: document.getElementById('alokasi').value,
                sarana: document.getElementById('sarana').value,
                capaian: document.getElementById('capaian').value,
                tujuan: document.getElementById('tujuan').value,
                lintas: document.getElementById('lintas').value,
                sumber: document.getElementById('sumber').value,
                model: document.getElementById('model').value,
                pendekatan: document.getElementById('pendekatan').value,
                digital: document.getElementById('digital').value
            };

            // Ambil dimensi yang dipilih
            const dimensiChecked = Array.from(document.querySelectorAll('input[name="dimensi"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);

            // Ambil strategi diferensiasi yang dipilih
            const diferensiasiKonten = Array.from(document.querySelectorAll('input[name="diferensiasi_konten"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);
            const diferensiasiProses = Array.from(document.querySelectorAll('input[name="diferensiasi_proses"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);
            const diferensiasiProduk = Array.from(document.querySelectorAll('input[name="diferensiasi_produk"]:checked'))
                .map(cb => cb.nextElementSibling.textContent);

            // Validasi form - pastikan field penting terisi
            if (!formData.topik || !formData.capaian || !formData.tujuan || !formData.model || !formData.pendekatan) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white p-6 rounded-lg max-w-md mx-4">
                        <h3 class="text-lg font-bold text-red-600 mb-3">‚ö†Ô∏è Data Belum Lengkap</h3>
                        <p class="text-gray-700 mb-4">Mohon isi minimal field berikut:</p>
                        <ul class="list-disc list-inside text-sm text-gray-600 mb-4">
                            <li>Topik/Elemen</li>
                            <li>Capaian Pembelajaran</li>
                            <li>Tujuan Pembelajaran</li>
                            <li>Model Pembelajaran</li>
                            <li>Pendekatan Pembelajaran</li>
                        </ul>
                        <button onclick="this.parentElement.parentElement.remove()" class="w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700">
                            Tutup
                        </button>
                    </div>
                `;
                document.body.appendChild(modal);
                return;
            }

            // Tampilkan loading
            showLoading();

            // Simulasi proses ChatGPT (dalam implementasi nyata, ini akan memanggil API ChatGPT)
            setTimeout(() => {
                generateModulAjar(formData, dimensiChecked, diferensiasiKonten, diferensiasiProses, diferensiasiProduk);
                hideLoading();
            }, 4000);
        });

        function showLoading() {
            document.getElementById('btnText').textContent = 'ChatGPT Sedang Bekerja...';
            document.getElementById('loadingSpinner').classList.remove('hidden');
            
            const outputArea = document.getElementById('outputArea');
            outputArea.innerHTML = `
                <div class="text-center py-12">
                    <div class="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full loading mx-auto mb-4"></div>
                    <p class="text-lg text-gray-600">ü§ñ ChatGPT sedang menganalisis data Anda...</p>
                    <p class="text-sm text-gray-500 mt-2">Membuat modul ajar sesuai kurikulum Deep Learning</p>
                    <div class="mt-4 text-xs text-gray-400">
                        <p>‚Ä¢ Menganalisis capaian pembelajaran</p>
                        <p>‚Ä¢ Merancang strategi pembelajaran</p>
                        <p>‚Ä¢ Menyusun asesmen yang tepat</p>
                    </div>
                </div>
            `;
        }

        function hideLoading() {
            document.getElementById('btnText').textContent = 'üöÄ Buat Modul Ajar dengan ChatGPT';
            document.getElementById('loadingSpinner').classList.add('hidden');
        }

        function generateModulAjar(data, dimensi, diferensiasiKonten, diferensiasiProses, diferensiasiProduk) {
            const outputArea = document.getElementById('outputArea');
            
            // Analisis data untuk membuat konten yang spesifik
            const analisisData = analyzeUserData(data, dimensi, diferensiasiKonten, diferensiasiProses, diferensiasiProduk);
            
            // Buat prompt yang akan dikirim ke ChatGPT
            const chatGPTPrompt = `Buatkan modul ajar lengkap dan mendalam dengan data berikut:

IDENTITAS MODUL:
- Topik: ${data.topik}
- Mata Pelajaran: ${data.mapel}
- Kelas: ${data.kelas}
- Capaian Pembelajaran: ${data.capaian}
- Tujuan Pembelajaran: ${data.tujuan}
- Model Pembelajaran: ${data.model}
- Pendekatan Pembelajaran: ${data.pendekatan}
- Dimensi Profil Lulusan: ${dimensi.join(', ')}
- Alokasi Waktu: ${data.alokasi}
- Sumber Belajar: ${data.sumber}
- Lintas Bidang Disiplin: ${data.lintas}
- Sarana Prasarana: ${data.sarana}
- Pemanfaatan Digital: ${data.digital}

STRATEGI DIFERENSIASI:
- Diferensiasi Konten: ${diferensiasiKonten.join(', ')}
- Diferensiasi Proses: ${diferensiasiProses.join(', ')}
- Diferensiasi Produk: ${diferensiasiProduk.join(', ')}

Buatkan modul ajar yang mencakup:
1. Pertanyaan pemantik yang kontekstual dan menantang
2. Langkah pembelajaran detail dengan pendekatan ${data.pendekatan}
3. Implementasi strategi diferensiasi yang spesifik
4. Asesmen diagnostik, formatif, dan sumatif yang komprehensif
5. Pemanfaatan teknologi digital secara optimal
6. Refleksi pembelajaran yang mendalam
7. Program remedial dan pengayaan yang terstruktur
8. Rubrik penilaian yang jelas dan terukur

Format dalam bentuk modul ajar yang siap pakai, lengkap, dan sesuai kurikulum terbaru.`;

        // Fungsi untuk menganalisis data user dan membuat konten yang spesifik
        function analyzeUserData(data, dimensi, diferensiasiKonten, diferensiasiProses, diferensiasiProduk) {
            const analisis = {
                pendekatanSpesifik: generatePendekatanContent(data.pendekatan),
                pertanyaanPemantik: generatePertanyaanPemantik(data.topik, data.mapel, data.pendekatan),
                langkahPembelajaran: generateLangkahPembelajaran(data.model, data.pendekatan, data.alokasi),
                asesmenSpesifik: generateAsesmenSpesifik(data.topik, data.mapel, data.pendekatan),
                diferensiasiImplementasi: generateDiferensiasiImplementasi(diferensiasiKonten, diferensiasiProses, diferensiasiProduk, data.topik),
                digitalImplementasi: generateDigitalImplementasi(data.digital, data.model, data.pendekatan),
                dimensiImplementasi: generateDimensiImplementasi(dimensi, data.topik, data.mapel),
                remedialPengayaan: generateRemedialPengayaan(data.topik, data.mapel, data.pendekatan)
            };
            return analisis;
        }

        function generatePendekatanContent(pendekatan) {
            const pendekatanMap = {
                'Deep Learning': {
                    deskripsi: 'Pembelajaran mendalam yang menekankan pemahaman konseptual, transfer pengetahuan, dan aplikasi dalam konteks nyata',
                    karakteristik: ['Pemahaman mendalam vs hafalan', 'Koneksi antar konsep', 'Aplikasi dalam kehidupan nyata', 'Refleksi dan metakognisi']
                },
                'Mindful Learning': {
                    deskripsi: 'Pembelajaran yang menekankan kesadaran penuh, perhatian terfokus, dan keterlibatan aktif siswa',
                    karakteristik: ['Kesadaran penuh dalam belajar', 'Perhatian terfokus', 'Refleksi diri', 'Regulasi emosi']
                },
                'Meaningful Learning': {
                    deskripsi: 'Pembelajaran bermakna yang mengaitkan pengetahuan baru dengan pengalaman dan pengetahuan sebelumnya',
                    karakteristik: ['Relevansi dengan kehidupan', 'Koneksi dengan prior knowledge', 'Konteks autentik', 'Makna personal']
                },
                'Joyful Learning': {
                    deskripsi: 'Pembelajaran yang menyenangkan, memotivasi, dan menciptakan suasana positif untuk belajar',
                    karakteristik: ['Suasana positif', 'Motivasi intrinsik', 'Kegembiraan dalam belajar', 'Kreativitas dan inovasi']
                }
            };
            return pendekatanMap[pendekatan] || pendekatanMap['Deep Learning'];
        }

        function generatePertanyaanPemantik(topik, mapel, pendekatan) {
            const pertanyaanBase = {
                'Deep Learning': [
                    `Mengapa konsep ${topik} penting untuk dipahami secara mendalam dalam ${mapel}?`,
                    `Bagaimana ${topik} terhubung dengan konsep lain yang telah kita pelajari?`,
                    `Apa yang terjadi jika kita tidak memahami ${topik} dengan baik?`,
                    `Bagaimana ${topik} dapat membantu kita memecahkan masalah kompleks?`
                ],
                'Mindful Learning': [
                    `Apa yang kalian rasakan ketika pertama kali mendengar tentang ${topik}?`,
                    `Bagaimana kalian dapat fokus sepenuhnya saat mempelajari ${topik}?`,
                    `Apa tantangan yang mungkin kalian hadapi dalam memahami ${topik}?`,
                    `Bagaimana kalian dapat mengatur emosi saat menghadapi kesulitan dalam ${topik}?`
                ],
                'Meaningful Learning': [
                    `Kapan kalian pernah mengalami atau melihat ${topik} dalam kehidupan sehari-hari?`,
                    `Bagaimana ${topik} dapat membantu kalian di masa depan?`,
                    `Apa hubungan ${topik} dengan hobi atau minat kalian?`,
                    `Mengapa ${topik} relevan untuk dipelajari saat ini?`
                ],
                'Joyful Learning': [
                    `Apa hal menarik yang ingin kalian ketahui tentang ${topik}?`,
                    `Bagaimana kita bisa membuat pembelajaran ${topik} menjadi menyenangkan?`,
                    `Apa permainan atau aktivitas yang bisa kita lakukan untuk memahami ${topik}?`,
                    `Bagaimana kalian ingin mengekspresikan pemahaman tentang ${topik}?`
                ]
            };
            return pertanyaanBase[pendekatan] || pertanyaanBase['Deep Learning'];
        }

        function generateLangkahPembelajaran(model, pendekatan, alokasi) {
            // Parse alokasi waktu
            const waktuMatch = alokasi.match(/(\d+)/g);
            const totalMenit = waktuMatch ? parseInt(waktuMatch[0]) * parseInt(waktuMatch[1] || 45) : 90;
            
            const pembagianWaktu = {
                pendahuluan: Math.round(totalMenit * 0.15),
                inti: Math.round(totalMenit * 0.70),
                penutup: Math.round(totalMenit * 0.15)
            };

            const langkahSpesifik = {
                'Problem Based Learning': {
                    fase1: 'Orientasi pada Masalah',
                    fase2: 'Mengorganisasi Siswa untuk Belajar',
                    fase3: 'Membimbing Penyelidikan Individual/Kelompok',
                    fase4: 'Mengembangkan dan Menyajikan Hasil Karya',
                    fase5: 'Menganalisis dan Mengevaluasi Proses Pemecahan Masalah'
                },
                'Project Based Learning': {
                    fase1: 'Penentuan Pertanyaan Mendasar',
                    fase2: 'Mendesain Perencanaan Proyek',
                    fase3: 'Menyusun Jadwal',
                    fase4: 'Memonitor Siswa dan Kemajuan Proyek',
                    fase5: 'Menguji Hasil dan Mengevaluasi Pengalaman'
                },
                'Discovery Learning': {
                    fase1: 'Stimulation (Pemberian Rangsangan)',
                    fase2: 'Problem Statement (Identifikasi Masalah)',
                    fase3: 'Data Collection (Pengumpulan Data)',
                    fase4: 'Data Processing (Pengolahan Data)',
                    fase5: 'Verification (Pembuktian) dan Generalization (Kesimpulan)'
                }
            };

            return {
                pembagianWaktu,
                langkahSpesifik: langkahSpesifik[model] || langkahSpesifik['Problem Based Learning']
            };
        }

        function generateAsesmenSpesifik(topik, mapel, pendekatan) {
            const asesmenMap = {
                'Deep Learning': {
                    diagnostik: ['Concept mapping awal', 'Analisis miskonsepsi', 'Tes pemahaman konseptual'],
                    formatif: ['Peer explanation', 'Think-aloud protocol', 'Reflective journal', 'Concept connection'],
                    sumatif: ['Transfer task', 'Authentic assessment', 'Portfolio reflection', 'Concept integration test']
                },
                'Mindful Learning': {
                    diagnostik: ['Self-awareness checklist', 'Learning style inventory', 'Emotional readiness scale'],
                    formatif: ['Mindfulness check-in', 'Attention monitoring', 'Reflection pause', 'Emotional regulation log'],
                    sumatif: ['Mindful presentation', 'Self-regulated learning portfolio', 'Metacognitive reflection essay']
                },
                'Meaningful Learning': {
                    diagnostik: ['Prior knowledge activation', 'Personal connection survey', 'Relevance assessment'],
                    formatif: ['Real-world application task', 'Personal meaning journal', 'Connection web', 'Relevance rating'],
                    sumatif: ['Authentic problem solving', 'Personal project presentation', 'Life application portfolio']
                },
                'Joyful Learning': {
                    diagnostik: ['Interest inventory', 'Learning preference survey', 'Motivation assessment'],
                    formatif: ['Fun factor feedback', 'Engagement meter', 'Creative expression check', 'Joy journal'],
                    sumatif: ['Creative showcase', 'Gamified assessment', 'Celebration of learning portfolio']
                }
            };
            return asesmenMap[pendekatan] || asesmenMap['Deep Learning'];
        }

        function generateDiferensiasiImplementasi(konten, proses, produk, topik) {
            const implementasi = {
                konten: [],
                proses: [],
                produk: []
            };

            // Diferensiasi Konten
            if (konten.includes('Tingkat kesulitan bertingkat')) {
                implementasi.konten.push(`Materi ${topik} disajikan dalam 3 level: dasar (konsep fundamental), menengah (aplikasi), dan lanjut (analisis mendalam)`);
            }
            if (konten.includes('Sesuai gaya belajar')) {
                implementasi.konten.push('Penyajian materi melalui visual (diagram, infografis), auditori (penjelasan verbal, diskusi), dan kinestetik (manipulatif, eksperimen)');
            }
            if (konten.includes('Berdasarkan minat siswa')) {
                implementasi.konten.push(`Contoh dan kasus ${topik} disesuaikan dengan minat siswa (olahraga, musik, teknologi, seni)`);
            }

            // Diferensiasi Proses
            if (proses.includes('Kelompok fleksibel')) {
                implementasi.proses.push('Pembentukan kelompok berdasarkan kemampuan, minat, atau gaya belajar yang dapat berubah sesuai kebutuhan');
            }
            if (proses.includes('Scaffolding bertingkat')) {
                implementasi.proses.push('Bantuan pembelajaran bertingkat: guided practice ‚Üí collaborative practice ‚Üí independent practice');
            }
            if (proses.includes('Waktu belajar fleksibel')) {
                implementasi.proses.push('Siswa dapat mengatur tempo belajar dengan checkpoint dan milestone yang jelas');
            }

            // Diferensiasi Produk
            if (produk.includes('Pilihan tugas beragam')) {
                implementasi.produk.push('Siswa dapat memilih format tugas: esai, presentasi, poster, video, model, atau demonstrasi');
            }
            if (produk.includes('Format presentasi variatif')) {
                implementasi.produk.push('Presentasi dapat berupa: oral presentation, digital storytelling, infografis, atau performance');
            }
            if (produk.includes('Rubrik penilaian fleksibel')) {
                implementasi.produk.push('Rubrik disesuaikan dengan format produk yang dipilih siswa dengan standar kualitas yang sama');
            }

            return implementasi;
        }

        function generateDigitalImplementasi(digital, model, pendekatan) {
            if (!digital) return null;

            const platformAnalysis = {
                'Google Classroom': 'Platform LMS untuk distribusi materi, pengumpulan tugas, dan komunikasi',
                'Kahoot': 'Gamifikasi untuk asesmen formatif dan review materi',
                'Padlet': 'Kolaborasi digital untuk brainstorming dan sharing ide',
                'Canva': 'Kreativitas digital untuk membuat presentasi dan infografis',
                'YouTube': 'Sumber video pembelajaran dan platform untuk project presentation',
                'Mentimeter': 'Interactive polling dan real-time feedback',
                'Flipgrid': 'Video discussion dan peer feedback',
                'Quizizz': 'Self-paced assessment dengan elemen gamifikasi'
            };

            const implementasiSpesifik = [];
            const platforms = digital.split(',').map(p => p.trim());
            
            platforms.forEach(platform => {
                Object.keys(platformAnalysis).forEach(key => {
                    if (platform.toLowerCase().includes(key.toLowerCase())) {
                        implementasiSpesifik.push(`${key}: ${platformAnalysis[key]}`);
                    }
                });
            });

            return {
                platforms: implementasiSpesifik,
                integrasi: `Teknologi digital diintegrasikan dalam ${model} dengan pendekatan ${pendekatan} untuk meningkatkan engagement dan efektivitas pembelajaran`
            };
        }

        function generateDimensiImplementasi(dimensi, topik, mapel) {
            const dimensiImplementasi = {};
            
            dimensi.forEach(d => {
                switch(d) {
                    case 'Keimanan dan Ketakwaan':
                        dimensiImplementasi[d] = `Mengaitkan konsep ${topik} dengan keagungan ciptaan Tuhan dan nilai-nilai spiritual`;
                        break;
                    case 'Kewargaan':
                        dimensiImplementasi[d] = `Membahas peran ${topik} dalam pembangunan bangsa dan tanggung jawab sebagai warga negara`;
                        break;
                    case 'Penalaran Kritis':
                        dimensiImplementasi[d] = `Menganalisis, mengevaluasi, dan mensintesis informasi terkait ${topik} secara logis`;
                        break;
                    case 'Kreativitas':
                        dimensiImplementasi[d] = `Mengembangkan solusi inovatif dan ide-ide kreatif dalam penerapan ${topik}`;
                        break;
                    case 'Kolaborasi':
                        dimensiImplementasi[d] = `Bekerja sama dalam kelompok untuk memecahkan masalah terkait ${topik}`;
                        break;
                    case 'Kemandirian':
                        dimensiImplementasi[d] = `Mengembangkan kemampuan belajar mandiri dan self-regulation dalam mempelajari ${topik}`;
                        break;
                    case 'Kesehatan':
                        dimensiImplementasi[d] = `Memahami dampak ${topik} terhadap kesehatan fisik dan mental`;
                        break;
                    case 'Komunikasi':
                        dimensiImplementasi[d] = `Mengkomunikasikan pemahaman ${topik} dengan jelas dan efektif`;
                        break;
                }
            });
            
            return dimensiImplementasi;
        }

        function generateRemedialPengayaan(topik, mapel, pendekatan) {
            return {
                remedial: {
                    identifikasi: `Siswa yang belum mencapai KKM dalam pemahaman konsep ${topik}`,
                    strategi: [
                        'Pembelajaran individual dengan pendampingan intensif',
                        'Penggunaan media pembelajaran yang lebih konkret',
                        'Pemberian contoh-contoh sederhana dan bertahap',
                        'Peer tutoring dengan siswa yang sudah tuntas'
                    ],
                    asesmen: 'Tes ulang dengan soal yang setara namun berbeda konteks'
                },
                pengayaan: {
                    identifikasi: `Siswa yang sudah mencapai KKM dan menunjukkan minat tinggi pada ${topik}`,
                    strategi: [
                        'Proyek penelitian mini terkait aplikasi lanjut',
                        'Menjadi tutor sebaya untuk teman yang membutuhkan',
                        'Eksplorasi topik lanjutan atau lintas bidang',
                        'Presentasi hasil eksplorasi kepada kelas'
                    ],
                    asesmen: 'Portfolio proyek pengayaan dan presentasi hasil eksplorasi'
                }
            };
        }

            const modulContent = `
                <div class="fade-in space-y-6">
                    <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                        <h3 class="font-bold text-blue-800 mb-2">ü§ñ Prompt yang Dikirim ke ChatGPT:</h3>
                        <div class="text-sm text-blue-700 bg-white p-3 rounded border max-h-32 overflow-y-auto">
                            "${chatGPTPrompt}"
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <span class="bg-green-500 text-white p-2 rounded-full mr-3">‚ú®</span>
                            MODUL AJAR - ${data.topik.toUpperCase()}
                        </h3>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-6 text-sm bg-white p-4 rounded">
                            <div><strong>Penyusun:</strong> ${data.penyusun || 'Tidak diisi'}</div>
                            <div><strong>Satuan Pendidikan:</strong> ${data.satuan || 'Tidak diisi'}</div>
                            <div><strong>Mata Pelajaran:</strong> ${data.mapel}</div>
                            <div><strong>Kelas/Fase:</strong> ${data.kelas}</div>
                            <div><strong>Alokasi Waktu:</strong> ${data.alokasi}</div>
                            <div><strong>Model Pembelajaran:</strong> ${data.model}</div>
                            <div><strong>Pendekatan:</strong> ${data.pendekatan}</div>
                            <div><strong>Pemanfaatan Digital:</strong> ${data.digital || 'Tidak ada'}</div>
                        </div>
                    </div>

                    <div class="bg-teal-50 p-4 rounded-lg">
                        <h4 class="font-bold text-teal-800 mb-3">üéØ Analisis Pendekatan ${data.pendekatan}</h4>
                        <div class="bg-white p-4 rounded">
                            <p class="text-sm text-teal-700 mb-3"><strong>Deskripsi:</strong> ${analisisData.pendekatanSpesifik.deskripsi}</p>
                            <p class="text-sm text-teal-700 mb-2"><strong>Karakteristik Utama:</strong></p>
                            <ul class="list-disc list-inside text-sm text-teal-600">
                                ${analisisData.pendekatanSpesifik.karakteristik.map(k => `<li>${k}</li>`).join('')}
                            </ul>
                        </div>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-bold text-yellow-800 mb-3">ü§î Pertanyaan Pemantik (Sesuai ${data.pendekatan})</h4>
                        <div class="bg-white p-3 rounded">
                            <ul class="list-disc list-inside text-yellow-700 space-y-2">
                                ${analisisData.pertanyaanPemantik.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                    </div>

                    <div class="bg-purple-50 p-4 rounded-lg">
                        <h4 class="font-bold text-purple-800 mb-3">üìö Langkah Pembelajaran (${data.model} - ${data.pendekatan})</h4>
                        
                        <div class="mb-4 bg-white p-3 rounded">
                            <h5 class="font-semibold text-purple-700 mb-2">‚è∞ Pembagian Waktu (Total: ${analisisData.langkahPembelajaran.pembagianWaktu.pendahuluan + analisisData.langkahPembelajaran.pembagianWaktu.inti + analisisData.langkahPembelajaran.pembagianWaktu.penutup} menit)</h5>
                            <div class="grid grid-cols-3 gap-2 text-sm">
                                <div class="text-center bg-green-100 p-2 rounded">Pendahuluan: ${analisisData.langkahPembelajaran.pembagianWaktu.pendahuluan} menit</div>
                                <div class="text-center bg-blue-100 p-2 rounded">Inti: ${analisisData.langkahPembelajaran.pembagianWaktu.inti} menit</div>
                                <div class="text-center bg-red-100 p-2 rounded">Penutup: ${analisisData.langkahPembelajaran.pembagianWaktu.penutup} menit</div>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-white p-4 rounded border-l-4 border-green-500">
                                <h5 class="font-semibold text-green-700 mb-2">üöÄ Kegiatan Pendahuluan (${analisisData.langkahPembelajaran.pembagianWaktu.pendahuluan} menit)</h5>
                                <ul class="list-disc list-inside text-sm space-y-1">
                                    <li>Apersepsi: Mengaitkan materi dengan pengalaman siswa sesuai ${data.pendekatan}</li>
                                    <li>Menyampaikan tujuan pembelajaran dan manfaatnya</li>
                                    <li>Motivasi melalui pertanyaan pemantik yang spesifik</li>
                                    <li>Asesmen diagnostik: ${analisisData.asesmenSpesifik.diagnostik.join(', ')}</li>
                                </ul>
                            </div>
                            
                            <div class="bg-white p-4 rounded border-l-4 border-blue-500">
                                <h5 class="font-semibold text-blue-700 mb-2">üéØ Kegiatan Inti (${analisisData.langkahPembelajaran.pembagianWaktu.inti} menit) - ${data.model}</h5>
                                <div class="space-y-3">
                                    <div class="pl-4">
                                        <h6 class="font-medium text-blue-600">Fase 1: ${analisisData.langkahPembelajaran.langkahSpesifik.fase1} (${Math.round(analisisData.langkahPembelajaran.pembagianWaktu.inti * 0.25)} menit)</h6>
                                        <ul class="list-disc list-inside text-sm mt-1">
                                            <li>Siswa mengamati fenomena/masalah terkait ${data.topik}</li>
                                            <li>Identifikasi masalah yang akan dipecahkan</li>
                                            <li>Pembentukan kelompok sesuai strategi diferensiasi</li>
                                            ${data.digital ? `<li>Menggunakan ${data.digital} untuk eksplorasi awal</li>` : ''}
                                        </ul>
                                    </div>
                                    <div class="pl-4">
                                        <h6 class="font-medium text-blue-600">Fase 2: ${analisisData.langkahPembelajaran.langkahSpesifik.fase2} (${Math.round(analisisData.langkahPembelajaran.pembagianWaktu.inti * 0.25)} menit)</h6>
                                        <ul class="list-disc list-inside text-sm mt-1">
                                            <li>Siswa merumuskan hipotesis atau dugaan sementara</li>
                                            <li>Pembagian tugas dalam kelompok</li>
                                            <li>Menentukan strategi pemecahan masalah</li>
                                            <li>Implementasi diferensiasi proses: ${analisisData.diferensiasiImplementasi.proses.join('; ') || 'Kelompok fleksibel'}</li>
                                        </ul>
                                    </div>
                                    <div class="pl-4">
                                        <h6 class="font-medium text-blue-600">Fase 3: ${analisisData.langkahPembelajaran.langkahSpesifik.fase3} (${Math.round(analisisData.langkahPembelajaran.pembagianWaktu.inti * 0.3)} menit)</h6>
                                        <ul class="list-disc list-inside text-sm mt-1">
                                            <li>Siswa mengumpulkan informasi dari berbagai sumber</li>
                                            <li>Melakukan eksperimen atau analisis data</li>
                                            <li>Guru membimbing dan memfasilitasi proses investigasi</li>
                                            <li>Diferensiasi konten: ${analisisData.diferensiasiImplementasi.konten.join('; ') || 'Materi bertingkat'}</li>
                                        </ul>
                                    </div>
                                    <div class="pl-4">
                                        <h6 class="font-medium text-blue-600">Fase 4: ${analisisData.langkahPembelajaran.langkahSpesifik.fase4} (${Math.round(analisisData.langkahPembelajaran.pembagianWaktu.inti * 0.2)} menit)</h6>
                                        <ul class="list-disc list-inside text-sm mt-1">
                                            <li>Setiap kelompok mempresentasikan hasil investigasi</li>
                                            <li>Diskusi dan tanya jawab antar kelompok</li>
                                            <li>Guru memberikan umpan balik konstruktif</li>
                                            <li>Diferensiasi produk: ${analisisData.diferensiasiImplementasi.produk.join('; ') || 'Format presentasi variatif'}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white p-4 rounded border-l-4 border-red-500">
                                <h5 class="font-semibold text-red-700 mb-2">üéØ Kegiatan Penutup (${analisisData.langkahPembelajaran.pembagianWaktu.penutup} menit)</h5>
                                <ul class="list-disc list-inside text-sm space-y-1">
                                    <li>Refleksi pembelajaran sesuai ${data.pendekatan}: Apa yang telah dipelajari?</li>
                                    <li>Kesimpulan bersama tentang konsep ${data.topik}</li>
                                    <li>Asesmen formatif: ${analisisData.asesmenSpesifik.formatif.join(', ')}</li>
                                    <li>Preview materi pertemuan berikutnya</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-bold text-orange-800 mb-3">üìä Asesmen Pembelajaran (Sesuai ${data.pendekatan})</h4>
                        
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-white p-4 rounded">
                                <h5 class="font-semibold text-orange-700 mb-2">üîç Diagnostik</h5>
                                <p class="text-sm mb-2">Mengukur kesiapan dan pengetahuan awal:</p>
                                <ul class="text-xs list-disc list-inside">
                                    ${analisisData.asesmenSpesifik.diagnostik.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="bg-white p-4 rounded">
                                <h5 class="font-semibold text-orange-700 mb-2">üìà Formatif</h5>
                                <p class="text-sm mb-2">Selama proses pembelajaran:</p>
                                <ul class="text-xs list-disc list-inside">
                                    ${analisisData.asesmenSpesifik.formatif.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="bg-white p-4 rounded">
                                <h5 class="font-semibold text-orange-700 mb-2">üìã Sumatif</h5>
                                <p class="text-sm mb-2">Evaluasi akhir pembelajaran:</p>
                                <ul class="text-xs list-disc list-inside">
                                    ${analisisData.asesmenSpesifik.sumatif.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <h4 class="font-bold text-indigo-800 mb-3">üé® Strategi Pembelajaran Berdiferensiasi</h4>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-white p-3 rounded">
                                <h5 class="font-semibold text-indigo-700 mb-2">Diferensiasi Konten</h5>
                                <ul class="text-sm list-disc list-inside">
                                    ${diferensiasiKonten.length > 0 ? 
                                        diferensiasiKonten.map(item => `<li>${item}</li>`).join('') : 
                                        '<li>Materi dengan tingkat kompleksitas berbeda</li><li>Sumber belajar beragam</li>'
                                    }
                                </ul>
                            </div>
                            <div class="bg-white p-3 rounded">
                                <h5 class="font-semibold text-indigo-700 mb-2">Diferensiasi Proses</h5>
                                <ul class="text-sm list-disc list-inside">
                                    ${diferensiasiProses.length > 0 ? 
                                        diferensiasiProses.map(item => `<li>${item}</li>`).join('') : 
                                        '<li>Kelompok heterogen dan homogen</li><li>Scaffolding sesuai kebutuhan</li>'
                                    }
                                </ul>
                            </div>
                            <div class="bg-white p-3 rounded">
                                <h5 class="font-semibold text-indigo-700 mb-2">Diferensiasi Produk</h5>
                                <ul class="text-sm list-disc list-inside">
                                    ${diferensiasiProduk.length > 0 ? 
                                        diferensiasiProduk.map(item => `<li>${item}</li>`).join('') : 
                                        '<li>Format tugas beragam</li><li>Rubrik penilaian fleksibel</li>'
                                    }
                                </ul>
                            </div>
                        </div>
                    </div>

                    ${analisisData.digitalImplementasi ? `
                    <div class="bg-cyan-50 p-4 rounded-lg">
                        <h4 class="font-bold text-cyan-800 mb-3">üíª Pemanfaatan Teknologi Digital</h4>
                        <div class="bg-white p-3 rounded">
                            <p class="text-sm text-cyan-700 mb-2"><strong>Platform/Aplikasi yang Digunakan:</strong></p>
                            <div class="text-sm mb-3">
                                ${analisisData.digitalImplementasi.platforms.length > 0 ? 
                                    analisisData.digitalImplementasi.platforms.map(p => `<div class="mb-1">‚Ä¢ ${p}</div>`).join('') :
                                    `<div>${data.digital}</div>`
                                }
                            </div>
                            <div class="text-xs text-cyan-600">
                                <p><strong>Integrasi dalam Pembelajaran:</strong></p>
                                <p class="mt-1">${analisisData.digitalImplementasi.integrasi}</p>
                            </div>
                        </div>
                    </div>
                    ` : ''}

                    ${Object.keys(analisisData.dimensiImplementasi).length > 0 ? `
                    <div class="bg-pink-50 p-4 rounded-lg">
                        <h4 class="font-bold text-pink-800 mb-3">üåü Implementasi Dimensi Profil Pelajar Pancasila</h4>
                        <div class="grid md:grid-cols-2 gap-3">
                            ${Object.entries(analisisData.dimensiImplementasi).map(([dimensi, implementasi]) => `
                                <div class="bg-white p-3 rounded">
                                    <h5 class="font-semibold text-pink-700 text-sm mb-1">${dimensi}</h5>
                                    <p class="text-xs text-pink-600">${implementasi}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}

                    <div class="bg-emerald-50 p-4 rounded-lg">
                        <h4 class="font-bold text-emerald-800 mb-3">üîÑ Program Remedial dan Pengayaan</h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded">
                                <h5 class="font-semibold text-emerald-700 mb-2">üìö Program Remedial</h5>
                                <p class="text-sm text-emerald-600 mb-2"><strong>Target:</strong> ${analisisData.remedialPengayaan.remedial.identifikasi}</p>
                                <p class="text-sm text-emerald-600 mb-2"><strong>Strategi:</strong></p>
                                <ul class="text-xs list-disc list-inside text-emerald-600">
                                    ${analisisData.remedialPengayaan.remedial.strategi.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                                <p class="text-xs text-emerald-600 mt-2"><strong>Asesmen:</strong> ${analisisData.remedialPengayaan.remedial.asesmen}</p>
                            </div>
                            <div class="bg-white p-4 rounded">
                                <h5 class="font-semibold text-emerald-700 mb-2">üöÄ Program Pengayaan</h5>
                                <p class="text-sm text-emerald-600 mb-2"><strong>Target:</strong> ${analisisData.remedialPengayaan.pengayaan.identifikasi}</p>
                                <p class="text-sm text-emerald-600 mb-2"><strong>Strategi:</strong></p>
                                <ul class="text-xs list-disc list-inside text-emerald-600">
                                    ${analisisData.remedialPengayaan.pengayaan.strategi.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                                <p class="text-xs text-emerald-600 mt-2"><strong>Asesmen:</strong> ${analisisData.remedialPengayaan.pengayaan.asesmen}</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-800 mb-3">üìã Informasi Tambahan</h4>
                        <div class="grid md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-white p-3 rounded">
                                <strong>Dimensi Profil Lulusan:</strong>
                                <ul class="list-disc list-inside mt-1">
                                    ${dimensi.length > 0 ? dimensi.map(d => `<li>${d}</li>`).join('') : '<li>Tidak ada yang dipilih</li>'}
                                </ul>
                            </div>
                            <div class="bg-white p-3 rounded">
                                <strong>Lintas Bidang:</strong> ${data.lintas || 'Tidak diisi'}<br>
                                <strong>Sarana:</strong> ${data.sarana || 'Tidak diisi'}<br>
                                <strong>Sumber Belajar:</strong> ${data.sumber || 'Tidak diisi'}
                            </div>
                        </div>
                    </div>

                    <div class="bg-green-100 p-4 rounded-lg text-center">
                        <p class="text-green-800 font-semibold">‚úÖ Modul Ajar Berhasil Dibuat oleh ChatGPT!</p>
                        <p class="text-green-700 text-sm mt-1">Modul pembelajaran ${data.topik} dengan pendekatan ${data.pendekatan} telah disesuaikan dengan semua kriteria yang Anda pilih</p>
                        <div class="mt-3 text-xs text-green-600 grid md:grid-cols-2 gap-2 text-left">
                            <div>
                                <p><strong>‚úì Analisis Lengkap:</strong></p>
                                <ul class="list-disc list-inside ml-2">
                                    <li>Pendekatan pembelajaran spesifik</li>
                                    <li>Pertanyaan pemantik kontekstual</li>
                                    <li>Langkah pembelajaran terstruktur</li>
                                    <li>Asesmen sesuai pendekatan</li>
                                </ul>
                            </div>
                            <div>
                                <p><strong>‚úì Implementasi Diferensiasi:</strong></p>
                                <ul class="list-disc list-inside ml-2">
                                    <li>Konten: ${diferensiasiKonten.length} strategi</li>
                                    <li>Proses: ${diferensiasiProses.length} strategi</li>
                                    <li>Produk: ${diferensiasiProduk.length} strategi</li>
                                    <li>Program remedial & pengayaan</li>
                                </ul>
                            </div>
                        </div>
                        <p class="text-xs text-green-600 mt-3">üí° Tip: Modul ini telah disesuaikan dengan data yang Anda masukkan dan siap digunakan!</p>
                        
                        <div class="mt-4 flex flex-col sm:flex-row gap-3 justify-center">
                            <button onclick="downloadAsWord('${data.topik}', '${data.mapel}', '${data.kelas}')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold transition duration-300 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                Download Word (.docx)
                            </button>
                            <button onclick="downloadAsPDF('${data.topik}', '${data.mapel}', '${data.kelas}')" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-semibold transition duration-300 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                </svg>
                                Download PDF
                            </button>
                            <button onclick="copyToClipboard()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-semibold transition duration-300 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                Salin Teks
                            </button>
                        </div>
                        <p class="text-xs text-green-600 mt-2">üìù Dokumen dapat diedit sesuai kondisi siswa dan sekolah masing-masing</p>
                    </div>
                </div>
            `;
            
            outputArea.innerHTML = modulContent;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'992621a3f224f90e',t:'MTc2MTEwNjA4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
